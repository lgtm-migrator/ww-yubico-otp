window.addEventListener("DOMContentLoaded",function(){function e(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),i(t).insertAdjacentHTML("afterend",'<div class="notice notice-error inline"><p>'+e+"</p></div>")}function t(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),i(t).insertAdjacentHTML("afterend",'<div class="notice notice-success inline"><p>'+e+"</p></div>")}function n(){var e=document.querySelector("#new-key + .notice");e&&e.parentNode.removeChild(e),(e=document.querySelector("#registered-keys + .notice"))&&e.parentNode.removeChild(e)}function o(e){e?(d.classList.add("is-active"),c.setAttribute("disabled","")):(d.classList.remove("is-active"),c.removeAttribute("disabled"))}function r(){o(!1),null!==this.response&&200===this.status?this.response.ok?(!function(){var e=l.querySelector("tr.no-items");e&&e.parentNode.removeChild(e)}(),l.insertAdjacentHTML("beforeend",this.response.row),t(this.response.message,"new-key"),p.value="",u.value="",i("_wpnonce").value=this.response.nonce):e(this.response.message,"new-key"):e(yotpSettings.serverError,"new-key")}function s(){this.tgt.querySelector(".spinner").classList.remove("is-active"),null!==this.response&&200===this.status?this.response.ok?(t(this.response.message,"registered-keys"),function(e){for(;null!==e&&"TR"!==e.tagName.toUpperCase();)e=e.parentNode;e&&e.parentNode.removeChild(e)}(this.tgt),function(){if(!l.getElementsByTagName("tr").length){var e=document.getElementById("tpl-empty").textContent;l.insertAdjacentHTML("beforeend",e)}}()):e(this.response.message,"registered-keys"):e(wwU2F.serverError,"registered-keys")}var i=document.getElementById.bind(document),a=i("new-key-form"),d=a.querySelector(".spinner"),c=i("submit-button"),l=i("the-list"),p=i("key-name"),u=i("otp");document.querySelector("table.yotp th.column-actions").style.width=0,a.addEventListener("submit",function(e){if(e.preventDefault(),a.reportValidity()){var t=p.value,s=u.value,d=i("_wpnonce").value,c=new XMLHttpRequest;n(),o(!0),c.open("POST",ajaxurl),c.addEventListener("load",r),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.responseType="json",c.send("action=wwyotp_register&n="+encodeURIComponent(t)+"&o="+encodeURIComponent(s)+"&_wpnonce="+encodeURIComponent(d))}}),document.querySelector("table.yotp > tbody").addEventListener("click",function(e){for(var t=e.target;null!==t&&(!t.tagName||"BUTTON"!==t.tagName.toUpperCase()||-1===t.className.indexOf("revoke-button"));)t=t.parentNode;if(t&&confirm(yotpSettings.revconfirm)){var o=t.dataset.key,r=t.dataset.nonce,i=new XMLHttpRequest;i.tgt=t,i.addEventListener("load",s),i.open("POST",ajaxurl),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.responseType="json";var a=t.querySelector(".spinner");a.style.float="none",a.style.margin=0,a.classList.add("is-active"),n(),i.send("action=wwyotp_revoke&key="+encodeURIComponent(o)+"&_wpnonce="+encodeURIComponent(r))}})});
//# sourceMappingURL=yotp-user.min.js.map
