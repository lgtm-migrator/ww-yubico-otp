!function(){var s,i,t,n,o,a,d;function r(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),s(t).insertAdjacentHTML("afterend",'<div class="notice notice-error inline"><p>'+e+"</p></div>")}function c(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),s(t).insertAdjacentHTML("afterend",'<div class="notice notice-success inline"><p>'+e+"</p></div>")}function l(){var e=document.querySelector("#new-key + .notice");e&&e.parentNode.removeChild(e),(e=document.querySelector("#registered-keys + .notice"))&&e.parentNode.removeChild(e)}function p(e){e?(t.classList.add("is-active"),n.setAttribute("disabled","")):(t.classList.remove("is-active"),n.removeAttribute("disabled"))}function u(){var e;(p(!1),null!==this.response&&200===this.status)?this.response.ok?((e=o.querySelector("tr.no-items"))&&e.parentNode.removeChild(e),o.insertAdjacentHTML("beforeend",this.response.row),c(this.response.message,"new-key"),a.value="",d.value="",s("_wpnonce").value=this.response.nonce):r(this.response.message,"new-key"):r(yotpSettings.serverError,"new-key")}function m(){this.tgt.querySelector(".spinner").classList.remove("is-active"),null!==this.response&&200===this.status?this.response.ok?(c(this.response.message,"registered-keys"),function(e){for(;null!==e&&"TR"!==e.tagName.toUpperCase();)e=e.parentNode;e&&e.parentNode.removeChild(e)}(this.tgt),function(){if(!o.getElementsByTagName("tr").length){var e=document.getElementById("tpl-empty").textContent;o.insertAdjacentHTML("beforeend",e)}}()):r(this.response.message,"registered-keys"):r(wwU2F.serverError,"registered-keys")}function e(){s=document.getElementById.bind(document),i=s("new-key-form"),t=i.querySelector(".spinner"),n=s("submit-button"),o=s("the-list"),a=s("key-name"),d=s("otp"),document.querySelector("table.yotp th.column-actions").style.width=0,i.addEventListener("submit",function(e){if(e.preventDefault(),i.reportValidity()){var t=a.value,n=d.value,o=s("_wpnonce").value,r=new XMLHttpRequest;l(),p(!0),r.open("POST",ajaxurl),r.addEventListener("load",u),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.responseType="json",r.send("action=wwyotp_register&n="+encodeURIComponent(t)+"&o="+encodeURIComponent(n)+"&_wpnonce="+encodeURIComponent(o))}}),document.querySelector("table.yotp > tbody").addEventListener("click",function(e){for(var t=e.target;null!==t&&(!t.tagName||"BUTTON"!==t.tagName.toUpperCase()||-1===t.className.indexOf("revoke-button"));)t=t.parentNode;if(t&&confirm(yotpSettings.revconfirm)){var n=t.dataset.key,o=t.dataset.nonce,r=new XMLHttpRequest;r.tgt=t,r.addEventListener("load",m),r.open("POST",ajaxurl),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.responseType="json";var s=t.querySelector(".spinner");s.style.float="none",s.style.margin=0,s.classList.add("is-active"),l(),r.send("action=wwyotp_revoke&key="+encodeURIComponent(n)+"&_wpnonce="+encodeURIComponent(o))}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}();
//# sourceMappingURL=yotp-user.min.js.map
